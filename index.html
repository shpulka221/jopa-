<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>–ù–ï–û–ù –ü–†–´–ñ–û–ö ULTRA</title>
<style>
body{margin:0;overflow:hidden;background:#050510;font-family:Arial;color:white;}
canvas{display:block;}
#ui{position:absolute;top:10px;width:100%;text-align:center;font-size:18px;z-index:5;}
#–º–µ–Ω—é,#–º–∞–≥–∞–∑–∏–Ω{
position:absolute;top:0;left:0;width:100%;height:100%;
background:rgba(0,0,0,0.95);
display:flex;flex-direction:column;align-items:center;justify-content:center;
}
button{
padding:10px 20px;margin:10px;
background:#111;border:2px solid #0ff;color:#0ff;font-size:18px;
}
#–º–∞–≥–∞–∑–∏–Ω{display:none;overflow:auto;}
.–ø—Ä–µ–¥–º–µ—Ç{border:1px solid #0ff;margin:10px;padding:10px;}
#—Ä–µ–∫–æ—Ä–¥{
position:absolute;top:40%;width:100%;text-align:center;
font-size:28px;color:#0ff;display:none;z-index:10;
}
</style>
</head>
<body>

<canvas id="–∏–≥—Ä–∞"></canvas>

<div id="ui">
–û—á–∫–∏: <span id="–æ—á–∫–∏">0</span> |
–ú–æ–Ω–µ—Ç—ã: <span id="–º–æ–Ω–µ—Ç—ã">0</span> |
–†–µ–∫–æ—Ä–¥: <span id="–ª—É—á—à–∏–π">0</span>
</div>

<div id="—Ä–µ–∫–æ—Ä–¥">üî• –ù–û–í–´–ô –†–ï–ö–û–†–î! +200 –ú–û–ù–ï–¢ üî•</div>

<div id="–º–µ–Ω—é">
<h1 style="color:#0ff">–ù–ï–û–ù –ü–†–´–ñ–û–ö</h1>
<button onclick="—Å—Ç–∞—Ä—Ç()">–ò–ì–†–ê–¢–¨</button>
<button onclick="–æ—Ç–∫—Ä—ã—Ç—å–ú–∞–≥–∞–∑–∏–Ω()">–ú–ê–ì–ê–ó–ò–ù</button>
</div>

<div id="–º–∞–≥–∞–∑–∏–Ω">
<h2>–ú–ê–ì–ê–ó–ò–ù</h2>
<div id="—Ç–æ–≤–∞—Ä—ã"></div>
<button onclick="–∑–∞–∫—Ä—ã—Ç—å–ú–∞–≥–∞–∑–∏–Ω()">–ù–ê–ó–ê–î</button>
</div>

<script>
const canvas=document.getElementById("–∏–≥—Ä–∞");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth;
canvas.height=innerHeight;

let audioCtx;
function –∑–∞–ø—É—Å—Ç–∏—Ç—å–ú—É–∑—ã–∫—É(){
audioCtx=new (window.AudioContext||window.webkitAudioContext)();
let osc=audioCtx.createOscillator();
let gain=audioCtx.createGain();
osc.type="sawtooth";
osc.frequency.value=110;
gain.gain.value=0.03;
osc.connect(gain);
gain.connect(audioCtx.destination);
osc.start();
}

let –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è=0.5;
let —Å–∏–ª–∞–ü—Ä—ã–∂–∫–∞=13;

let –∏–≥—Ä–æ–∫;
let –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã=[];
let –º–æ–Ω–µ—Ç—ã–û–±—ä–µ–∫—Ç—ã=[];
let —à–∏–ø—ã=[];
let –±–æ–Ω—É—Å—ã=[];

let –æ—á–∫–∏=0;
let –ª—É—á—à–∏–π=localStorage.–ª—É—á—à–∏–π?parseInt(localStorage.–ª—É—á—à–∏–π):0;
let –º–æ–Ω–µ—Ç—ã=localStorage.–º–æ–Ω–µ—Ç—ã?parseInt(localStorage.–º–æ–Ω–µ—Ç—ã):0;

let –¥–≤–æ–π–Ω—ã–µ–ú–æ–Ω–µ—Ç—ã=localStorage.–¥–º?true:false;
let —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π=localStorage.—Ñ–∏–æ?true:false;

document.getElementById("–ª—É—á—à–∏–π").innerText=–ª—É—á—à–∏–π;
document.getElementById("–º–æ–Ω–µ—Ç—ã").innerText=–º–æ–Ω–µ—Ç—ã;

let –∫–∞—Å–∞–Ω–∏–µ=false;
let –ø–∞–ª–µ—ÜX=0;
let –∏–≥—Ä–∞–ò–¥–µ—Ç=false;

function —Å–æ–∑–¥–∞—Ç—å–ò–≥—Ä–æ–∫–∞(){
–∏–≥—Ä–æ–∫={
x:canvas.width/2-15,
y:canvas.height-120,
w:30,
h:30,
vy:0,
—Ü–≤–µ—Ç:—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π?"#b300ff":"#0ff",
—Ç—Ä–µ–π–ª:false
};
}

function —Å–æ–∑–¥–∞—Ç—å–ü–ª–∞—Ç—Ñ–æ—Ä–º—É(x,y,–ª–æ–º–∞–µ—Ç—Å—è=false){
–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.push({x,y,w:90,h:12,–ª–æ–º–∞–µ—Ç—Å—è});
}

function —Å—Ç–∞—Ä—Ç(){
–∑–∞–ø—É—Å—Ç–∏—Ç—å–ú—É–∑—ã–∫—É();
–∏–≥—Ä–∞–ò–¥–µ—Ç=true;
–æ—á–∫–∏=0;
–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã=[];
–º–æ–Ω–µ—Ç—ã–û–±—ä–µ–∫—Ç—ã=[];
—à–∏–ø—ã=[];
–±–æ–Ω—É—Å—ã=[];
—Å–æ–∑–¥–∞—Ç—å–ò–≥—Ä–æ–∫–∞();

—Å–æ–∑–¥–∞—Ç—å–ü–ª–∞—Ç—Ñ–æ—Ä–º—É(canvas.width/2-45,canvas.height-80,false);

for(let i=1;i<12;i++){
let y=canvas.height-80-i*100;
—Å–æ–∑–¥–∞—Ç—å–ü–ª–∞—Ç—Ñ–æ—Ä–º—É(
Math.random()*(canvas.width-90),
y,
Math.random()<0.3
);
}

document.getElementById("–º–µ–Ω—é").style.display="none";
–∏–≥—Ä–∞();
}

function –∏–≥—Ä–∞(){
if(!–∏–≥—Ä–∞–ò–¥–µ—Ç)return;

ctx.fillStyle="#050510";
ctx.fillRect(0,0,canvas.width,canvas.height);

–∏–≥—Ä–æ–∫.vy+=–≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è;
–∏–≥—Ä–æ–∫.y+=–∏–≥—Ä–æ–∫.vy;

if(–∫–∞—Å–∞–Ω–∏–µ)
–∏–≥—Ä–æ–∫.x+=(–ø–∞–ª–µ—ÜX-–∏–≥—Ä–æ–∫.x-–∏–≥—Ä–æ–∫.w/2)*0.2;

if(–∏–≥—Ä–æ–∫.x<0)–∏–≥—Ä–æ–∫.x=0;
if(–∏–≥—Ä–æ–∫.x+–∏–≥—Ä–æ–∫.w>canvas.width)
–∏–≥—Ä–æ–∫.x=canvas.width-–∏–≥—Ä–æ–∫.w;

–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.forEach((p,i)=>{
if(
–∏–≥—Ä–æ–∫.vy>0 &&
–∏–≥—Ä–æ–∫.x+–∏–≥—Ä–æ–∫.w>p.x &&
–∏–≥—Ä–æ–∫.x<p.x+p.w &&
–∏–≥—Ä–æ–∫.y+–∏–≥—Ä–æ–∫.h>=p.y &&
–∏–≥—Ä–æ–∫.y+–∏–≥—Ä–æ–∫.h<=p.y+p.h+–∏–≥—Ä–æ–∫.vy
){
–∏–≥—Ä–æ–∫.vy=-—Å–∏–ª–∞–ü—Ä—ã–∂–∫–∞;

if(p.–ª–æ–º–∞–µ—Ç—Å—è){
–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.splice(i,1);
}
}
});

if(–∏–≥—Ä–æ–∫.y<canvas.height/2){
let diff=canvas.height/2-–∏–≥—Ä–æ–∫.y;
–∏–≥—Ä–æ–∫.y=canvas.height/2;
–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.forEach(p=>p.y+=diff);
–æ—á–∫–∏+=Math.floor(diff);
}

if(–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã[0].y>canvas.height){
–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.shift();
—Å–æ–∑–¥–∞—Ç—å–ü–ª–∞—Ç—Ñ–æ—Ä–º—É(
Math.random()*(canvas.width-90),
0,
Math.random()<0.3
);
}

ctx.fillStyle=–∏–≥—Ä–æ–∫.—Ü–≤–µ—Ç;
ctx.fillRect(–∏–≥—Ä–æ–∫.x,–∏–≥—Ä–æ–∫.y,–∏–≥—Ä–æ–∫.w,–∏–≥—Ä–æ–∫.h);

–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.forEach(p=>{
ctx.fillStyle=p.–ª–æ–º–∞–µ—Ç—Å—è?"#ff8800":"#0ff";
ctx.fillRect(p.x,p.y,p.w,p.h);
});

document.getElementById("–æ—á–∫–∏").innerText=–æ—á–∫–∏;

if(–∏–≥—Ä–æ–∫.y>canvas.height){
–∏–≥—Ä–∞–ò–¥–µ—Ç=false;
–∫–æ–Ω–µ—Ü();
return;
}

requestAnimationFrame(–∏–≥—Ä–∞);
}

function –∫–æ–Ω–µ—Ü(){
if(–æ—á–∫–∏>–ª—É—á—à–∏–π){
–ª—É—á—à–∏–π=–æ—á–∫–∏;
localStorage.–ª—É—á—à–∏–π=–ª—É—á—à–∏–π;
–º–æ–Ω–µ—Ç—ã+=200;
localStorage.–º–æ–Ω–µ—Ç—ã=–º–æ–Ω–µ—Ç—ã;
document.getElementById("–º–æ–Ω–µ—Ç—ã").innerText=–º–æ–Ω–µ—Ç—ã;
document.getElementById("–ª—É—á—à–∏–π").innerText=–ª—É—á—à–∏–π;
document.getElementById("—Ä–µ–∫–æ—Ä–¥").style.display="block";
setTimeout(()=>document.getElementById("—Ä–µ–∫–æ—Ä–¥").style.display="none",2000);
}
document.getElementById("–º–µ–Ω—é").style.display="flex";
}

canvas.addEventListener("touchstart",e=>{
–∫–∞—Å–∞–Ω–∏–µ=true;
–ø–∞–ª–µ—ÜX=e.touches[0].clientX;
});
canvas.addEventListener("touchmove",e=>{
–ø–∞–ª–µ—ÜX=e.touches[0].clientX;
});
canvas.addEventListener("touchend",()=>–∫–∞—Å–∞–Ω–∏–µ=false);

function –æ—Ç–∫—Ä—ã—Ç—å–ú–∞–≥–∞–∑–∏–Ω(){
document.getElementById("–º–∞–≥–∞–∑–∏–Ω").style.display="block";
document.getElementById("–º–µ–Ω—é").style.display="none";
–æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å–ú–∞–≥–∞–∑–∏–Ω();
}

function –∑–∞–∫—Ä—ã—Ç—å–ú–∞–≥–∞–∑–∏–Ω(){
document.getElementById("–º–∞–≥–∞–∑–∏–Ω").style.display="none";
document.getElementById("–º–µ–Ω—é").style.display="flex";
}

let —Ç–æ–≤–∞—Ä—ã=[
{–Ω–∞–∑–≤–∞–Ω–∏–µ:"–§–∏–æ–ª–µ—Ç–æ–≤—ã–π –Ω–µ–æ–Ω",—Ü–µ–Ω–∞:200,–¥–µ–π—Å—Ç–≤–∏–µ:()=>{—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π=true;localStorage.—Ñ–∏–æ=true;}},
{–Ω–∞–∑–≤–∞–Ω–∏–µ:"–î–≤–æ–π–Ω—ã–µ –º–æ–Ω–µ—Ç—ã",—Ü–µ–Ω–∞:300,–¥–µ–π—Å—Ç–≤–∏–µ:()=>{–¥–≤–æ–π–Ω—ã–µ–ú–æ–Ω–µ—Ç—ã=true;localStorage.–¥–º=true;}},
{–Ω–∞–∑–≤–∞–Ω–∏–µ:"–°–∏–ª—å–Ω—ã–π –ø—Ä—ã–∂–æ–∫",—Ü–µ–Ω–∞:250,–¥–µ–π—Å—Ç–≤–∏–µ:()=>{—Å–∏–ª–∞–ü—Ä—ã–∂–∫–∞+=3;}}
];

function –æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å–ú–∞–≥–∞–∑–∏–Ω(){
let –±–ª–æ–∫=document.getElementById("—Ç–æ–≤–∞—Ä—ã");
–±–ª–æ–∫.innerHTML="";
—Ç–æ–≤–∞—Ä—ã.forEach((t,i)=>{
let div=document.createElement("div");
div.className="–ø—Ä–µ–¥–º–µ—Ç";
div.innerHTML=`${t.–Ω–∞–∑–≤–∞–Ω–∏–µ} ‚Äî ${t.—Ü–µ–Ω–∞} –º–æ–Ω–µ—Ç
<br><button onclick="–∫—É–ø–∏—Ç—å(${i})">–ö–£–ü–ò–¢–¨</button>`;
–±–ª–æ–∫.appendChild(div);
});
}

function –∫—É–ø–∏—Ç—å(i){
let t=—Ç–æ–≤–∞—Ä—ã[i];
if(–º–æ–Ω–µ—Ç—ã>=t.—Ü–µ–Ω–∞){
–º–æ–Ω–µ—Ç—ã-=t.—Ü–µ–Ω–∞;
localStorage.–º–æ–Ω–µ—Ç—ã=–º–æ–Ω–µ—Ç—ã;
document.getElementById("–º–æ–Ω–µ—Ç—ã").innerText=–º–æ–Ω–µ—Ç—ã;
t.–¥–µ–π—Å—Ç–≤–∏–µ();
alert("–ö—É–ø–ª–µ–Ω–æ!");
}else{
alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");
}
}
</script>

</body>
</html>
