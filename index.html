<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NEON JUMP</title>
<style>
body{
margin:0;
overflow:hidden;
background:#050510;
font-family:Arial;
color:white;
}
canvas{
display:block;
background:linear-gradient(#0a0a1f,#000);
}
#ui{
position:fixed;
top:10px;
left:10px;
z-index:10;
}
button{
background:#111;
color:#0ff;
border:1px solid #0ff;
padding:8px 12px;
margin:3px;
cursor:pointer;
}
#shop{
position:fixed;
bottom:0;
left:0;
right:0;
background:#000c;
max-height:50%;
overflow:auto;
display:none;
padding:10px;
}
.item{
display:flex;
justify-content:space-between;
margin:5px 0;
}
</style>
</head>
<body>

<div id="ui">
<div id="score">–û—á–∫–∏: 0</div>
<div id="coins">–ú–æ–Ω–µ—Ç—ã: 0</div>
<button onclick="toggleShop()">–ú–∞–≥–∞–∑–∏–Ω</button>
</div>

<div id="shop"></div>

<canvas id="game"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth;
canvas.height=innerHeight;

let gravity=0.6;
let jumpPower=15;
let speedBoost=0;
let doubleCoins=false;
let shield=false;
let rainbow=false;
let trailType=0;

let score=0;
let best=localStorage.best?parseInt(localStorage.best):0;
let coins=localStorage.coins?parseInt(localStorage.coins):0;

let player={
x:canvas.width/2,
y:canvas.height-200,
w:30,
h:30,
vx:0,
vy:0,
color:"#0ff",
hat:0
};

let platforms=[];
let spikes=[];
let particles=[];
let touchX=null;
let playing=true;

function spawnPlatform(y){
let width=80+Math.random()*50;
let x=Math.random()*(canvas.width-width);
let type=Math.random();
platforms.push({
x,y,width,
breakable:type<0.2
});
if(type>0.7){
spikes.push({x:x+width/2-10,y:y-15});
}
}

for(let i=0;i<10;i++){
spawnPlatform(canvas.height-i*120);
}

function loop(){
if(!playing)return;
ctx.clearRect(0,0,canvas.width,canvas.height);

player.vy+=gravity;
player.y+=player.vy;

if(touchX!==null){
player.x+=(touchX-player.x-player.w/2)*(0.2+speedBoost);
}

if(player.y>canvas.height){
endGame();
return;
}

platforms.forEach(p=>{
ctx.fillStyle=p.breakable?"#f0f":"#0ff";
ctx.fillRect(p.x,p.y,p.width,10);

if(player.vy>0 &&
player.x+player.w>p.x &&
player.x<p.x+p.width &&
player.y+player.h>p.y &&
player.y+player.h<p.y+15){
player.vy=-jumpPower;
if(p.breakable){
setTimeout(()=>platforms.splice(platforms.indexOf(p),1),100);
}
score++;
if(doubleCoins)coins+=2; else coins++;
}
});

spikes.forEach(s=>{
ctx.fillStyle="red";
ctx.beginPath();
ctx.moveTo(s.x,s.y+20);
ctx.lineTo(s.x+20,s.y+20);
ctx.lineTo(s.x+10,s.y);
ctx.fill();

if(!shield &&
player.x+player.w>s.x &&
player.x<s.x+20 &&
player.y+player.h>s.y){
endGame();
}
});

if(rainbow){
player.color=`hsl(${Date.now()/10%360},100%,50%)`;
}

ctx.fillStyle=player.color;
ctx.fillRect(player.x,player.y,player.w,player.h);

if(player.hat===1){
ctx.fillStyle="#fff";
ctx.fillRect(player.x+5,player.y-10,20,8);
}
if(player.hat===2){
ctx.fillStyle="#ffd700";
ctx.fillRect(player.x+5,player.y-12,20,10);
}
if(player.hat===3){
ctx.strokeStyle="#0ff";
ctx.beginPath();
ctx.arc(player.x+15,player.y+15,25,0,Math.PI*2);
ctx.stroke();
}

scoreText();
requestAnimationFrame(loop);
}

function scoreText(){
document.getElementById("score").innerText="–û—á–∫–∏: "+score;
document.getElementById("coins").innerText="–ú–æ–Ω–µ—Ç—ã: "+coins;
}

function endGame(){
playing=false;
if(score>best){
best=score;
localStorage.best=best;
alert("üî• –†–µ–∫–æ—Ä–¥ –ø–æ–±–∏—Ç!");
}
localStorage.coins=coins;
setTimeout(()=>{
location.reload();
},1500);
}

canvas.addEventListener("touchstart",e=>{
touchX=e.touches[0].clientX;
});
canvas.addEventListener("touchmove",e=>{
touchX=e.touches[0].clientX;
});
canvas.addEventListener("touchend",()=>touchX=null);

function toggleShop(){
let shop=document.getElementById("shop");
shop.style.display=shop.style.display==="block"?"none":"block";
}

let shopItems=[
{title:"–ö—Ä–∞—Å–Ω—ã–π —Å–∫–∏–Ω",price:100,action:()=>player.color="#ff0000"},
{title:"–ó–µ–ª—ë–Ω—ã–π —Å–∫–∏–Ω",price:100,action:()=>player.color="#00ff00"},
{title:"–§–∏–æ–ª–µ—Ç–æ–≤—ã–π",price:200,action:()=>player.color="#b300ff"},
{title:"–ó–æ–ª–æ—Ç–æ–π",price:400,action:()=>player.color="#ffd700"},
{title:"–†–∞–¥—É–∂–Ω—ã–π",price:600,action:()=>rainbow=true},
{title:"+–ü—Ä—ã–∂–æ–∫",price:300,action:()=>jumpPower+=3},
{title:"+–°–∫–æ—Ä–æ—Å—Ç—å",price:300,action:()=>speedBoost=0.3},
{title:"–î–≤–æ–π–Ω—ã–µ –º–æ–Ω–µ—Ç—ã",price:500,action:()=>doubleCoins=true},
{title:"–©–∏—Ç 5 —Å–µ–∫",price:350,action:()=>{
shield=true;
setTimeout(()=>shield=false,5000);
}},
{title:"–ö–µ–ø–∫–∞",price:200,action:()=>player.hat=1},
{title:"–ö–æ—Ä–æ–Ω–∞",price:500,action:()=>player.hat=2},
{title:"–ê—É—Ä–∞",price:450,action:()=>player.hat=3}
];

function renderShop(){
let shop=document.getElementById("shop");
shop.innerHTML="";
shopItems.forEach(item=>{
let div=document.createElement("div");
div.className="item";
let btn=document.createElement("button");
btn.innerText="–ö—É–ø–∏—Ç—å";
btn.onclick=()=>{
if(coins>=item.price){
coins-=item.price;
item.action();
}else{
alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç");
}
};
div.innerHTML=`<span>${item.title} - ${item.price}</span>`;
div.appendChild(btn);
shop.appendChild(div);
});
}

renderShop();
loop();

let music=new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_115b9b7b75.mp3?filename=cyberpunk-11264.mp3");
music.loop=true;
music.volume=0.4;
music.play().catch(()=>{});

</script>
</body>
</html>
