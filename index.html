<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Cosmo Cafe</title>
<style>
html,body{margin:0;padding:0;font-family:Arial, sans-serif;background:black;overflow:hidden;}
#gameWrapper{position:relative;width:360px;height:640px;margin:auto;background:linear-gradient(to bottom, #ff9a9e, #fad0c4);}
canvas{display:block;}
#menu,#gameover,#shop{position:absolute;width:100%;text-align:center;color:white;z-index:2;}
#menu{top:10%;}
#shop{top:5%;display:none;}
#gameover{top:10%;display:none;}
button{padding:10px 20px;margin:10px;font-size:16px;cursor:pointer;border-radius:5px;}
#coinsDisplay{position:absolute;top:5px;left:5px;color:yellow;font-weight:bold;z-index:5;}
#adminButton{position:absolute;top:40px;right:10px;z-index:5;background:purple;color:white;border:none;padding:8px;border-radius:5px;}
</style>
</head>
<body>
<div id="gameWrapper">

<div id="menu">
<h1>Cosmo Cafe ‚òïüöÄ</h1>
<button onclick="startGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
<button onclick="openShop()">–ú–∞–≥–∞–∑–∏–Ω</button>
</div>

<div id="shop">
<h1>–ú–∞–≥–∞–∑–∏–Ω</h1>
<h3>–¶–≤–µ—Ç–∞ —à–µ—Ñ–∞</h3>
<div id="colorOptions"></div>
<h3>–ë–æ–Ω—É—Å—ã</h3>
<div id="bonusOptions"></div>
<button onclick="closeShop()">–ù–∞–∑–∞–¥</button>
</div>

<div id="gameover">
<h1>–ù–£ –¢–´ –ò –õ–û–•</h1>
<p id="finalScore"></p>
<button onclick="restartGame()">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button><br>
<button onclick="showMenu()">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
</div>

<div id="coinsDisplay">–ú–æ–Ω–µ—Ç—ã: 0</div>
<button id="adminButton" onclick="addAdminCoins()">+100 –º–æ–Ω–µ—Ç</button>
<canvas id="gameCanvas"></canvas>

</div>

<script>
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");
canvas.width=360; canvas.height=640;

// ------------------- –ü–ï–†–ï–ú–ï–ù–ù–´–ï -------------------
let player={x:180,y:580,radius:25,dy:0,gravity:0.6,jumpPower:-15};
let tables=[],orders=[],bonusItems=[],score=0,coins=parseInt(localStorage.getItem("coins")||0);
let gameStarted=false,gameOver=false,record=parseInt(localStorage.getItem("record")||0);
let playerColor=localStorage.getItem("playerColor")||"white";
let fireParticles=[],showFire=false,fireTimer=0;

// ------------------- –ú–ê–ì–ê–ó–ò–ù -------------------
const colors=[{color:"white",price:0},{color:"pink",price:100},{color:"blue",price:100},{color:"green",price:100}];
const bonuses=[{name:"–†–∞–∫–µ—Ç–∞",id:"rocket",price:200,owned:localStorage.getItem("owned_rocket")}];

function openShop(){document.getElementById("menu").style.display="none";document.getElementById("shop").style.display="block";renderShop();}
function closeShop(){document.getElementById("shop").style.display="none";document.getElementById("menu").style.display="block";}
function renderShop(){
let container=document.getElementById("colorOptions"); container.innerHTML="";
colors.forEach(c=>{
let owned=c.price===0||localStorage.getItem("owned_"+c.color);
let div=document.createElement("div"); div.style.width="35px"; div.style.height="35px"; div.style.display="inline-block";
div.style.border="2px solid white"; div.style.borderRadius="50%"; div.style.background=c.color; div.style.margin="5px";
div.onclick=()=>{buyColor(c.color,c.price);};
container.appendChild(div);
if(!owned && c.price>0){let span=document.createElement("span"); span.style.color="yellow"; span.innerText=c.price; div.appendChild(span);}
});
let bonusContainer=document.getElementById("bonusOptions"); bonusContainer.innerHTML="";
bonuses.forEach(b=>{let btn=document.createElement("button");btn.innerText=b.name+" ("+b.price+")"; btn.onclick=()=>buyBonus(b); if(b.owned){btn.innerText=b.name+" (–∫—É–ø–ª–µ–Ω–æ)";} bonusContainer.appendChild(btn);});
}
function buyColor(color,price){
let owned=price===0||localStorage.getItem("owned_"+color);
if(!owned){if(coins>=price){coins-=price; localStorage.setItem("coins",coins); localStorage.setItem("owned_"+color,1); playerColor=color; localStorage.setItem("playerColor",color); updateCoins();} else alert("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–æ–Ω–µ—Ç!");}
else{playerColor=color; localStorage.setItem("playerColor",color);}
}
function buyBonus(b){if(localStorage.getItem("owned_"+b.id))return;if(coins>=b.price){coins-=b.price; localStorage.setItem("coins",coins); localStorage.setItem("owned_"+b.id,1); b.owned=true; updateCoins(); renderShop();}else alert("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–æ–Ω–µ—Ç!");}

// ------------------- –°–ê–õ–Æ–¢ -------------------
function launchFire(){fireParticles=[]; for(let i=0;i<200;i++){fireParticles.push({x:180,y:150,dx:(Math.random()-0.5)*8,dy:(Math.random()-0.5)*8,life:60,color:`hsl(${Math.random()*360},100%,60%)`});} showFire=true; fireTimer=60;}
function updateFire(){if(showFire){fireParticles.forEach(p=>{p.x+=p.dx;p.y+=p.dy;p.life--; ctx.fillStyle=p.color; ctx.fillRect(p.x,p.y,4,4);}); fireParticles=fireParticles.filter(p=>p.life>0); fireTimer--; if(fireTimer<=0) showFire=false;}}

// ------------------- –ò–ì–†–ê -------------------
function initGame(){tables=[];orders=[];bonusItems=[];score=0;gameOver=false;gameStarted=true; player.y=580; player.dy=0;}
function createTable(x,y){tables.push({x,y,width:80,height:20,order:Math.random()<0.5?"burger":"coffee",served:false}); if(Math.random()<0.3) bonusItems.push({x:x+40,y:y-20,type:"coin",collected:false});}

// ------------------- –†–ò–°–û–í–ö–ê -------------------
function drawBackground(){ctx.fillStyle="black"; ctx.fillRect(0,0,360,640); ctx.fillStyle="linear-gradient(to bottom, #ff9a9e, #fad0c4)"; ctx.fillRect(0,0,360,640);}
function drawPlayer(){ctx.beginPath(); ctx.arc(player.x,player.y,player.radius,0,Math.PI*2); ctx.fillStyle=playerColor; ctx.fill();}
function drawTables(){tables.forEach(t=>{ctx.fillStyle=t.served?"lime":"white"; ctx.fillRect(t.x,t.y,t.width,t.height); ctx.fillStyle="black"; ctx.fillText(t.order,t.x+5,t.y+15);});}
function drawBonusItems(){bonusItems.forEach(b=>{if(!b.collected){ctx.beginPath(); ctx.fillStyle=b.type==="coin"?"yellow":"orange"; ctx.arc(b.x,b.y,8,0,Math.PI*2); ctx.fill();}});}

// ------------------- –û–ë–ù–û–í–õ–ï–ù–ò–ï -------------------
function update(){
ctx.clearRect(0,0,360,640); drawBackground(); drawTables(); drawBonusItems(); drawPlayer(); updateFire();
ctx.fillStyle="white"; ctx.font="16px Arial"; ctx.fillText("–ú–æ–Ω–µ—Ç—ã: "+coins,10,20); ctx.fillText("–†–µ–∫–æ—Ä–¥: "+record,10,40);
requestAnimationFrame(update);
}

// ------------------- –ù–ê–í–ò–ì–ê–¶–ò–Ø -------------------
function startGame(){document.getElementById("menu").style.display="none"; initGame();}
function restartGame(){document.getElementById("gameover").style.display="none"; initGame();}
function showMenu(){document.getElementById("gameover").style.display="none";document.getElementById("menu").style.display="block";gameStarted=false;}
function updateCoins(){document.getElementById("coinsDisplay").innerText="–ú–æ–Ω–µ—Ç—ã: "+coins;}
function addAdminCoins(){coins+=100; localStorage.setItem("coins",coins); updateCoins();}

// ------------------- –£–ü–†–ê–í–õ–ï–ù–ò–ï -------------------
canvas.addEventListener("touchmove",e=>{const rect=canvas.getBoundingClientRect();player.x=e.touches[0].clientX-rect.left;if(player.x<player.radius)player.x=player.radius;if(player.x>360-player.radius)player.x=360-player.radius;});

update();
</script>
</body>
</html>
